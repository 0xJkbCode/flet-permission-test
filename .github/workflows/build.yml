name: Build Flet Android APK

    on:
      push:
        branches: [ "main" ]
      workflow_dispatch:

    jobs:
      build:
        runs-on: ubuntu-latest

        steps:
        - uses: actions/checkout@v4
        - name: Set up Python
          uses: actions/setup-python@v5
          with:
            python-version: '3.11'
        - name: Set up Java
          uses: actions/setup-java@v4
          with:
            distribution: 'temurin'
            java-version: '17'
        - name: Set up Android SDK
          uses: android-actions/setup-android@v3
        - name: Install Flet
          run: python -m pip install --upgrade pip && pip install flet
        - name: Build APK
          run: |
            flet build apk flet_test_permisions.py -vv --android-permissions "android.permission.READ_CONTACTS,android.permission.WRITE_CONTACTS"
        - name: Upload APK Artifact
          uses: actions/upload-artifact@v4
          with:
            name: app-release
            path: build/apk/app-release.apk